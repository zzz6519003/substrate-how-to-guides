<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.73">
<link rel="alternate" type="application/rss+xml" href="/substrate-how-to-guides/blog/rss.xml" title="Substrate How-to Guides Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/substrate-how-to-guides/blog/atom.xml" title="Substrate How-to Guides Blog Atom Feed"><title data-react-helmet="true">Use the Contracts pallet | Substrate How-to Guides</title><meta data-react-helmet="true" property="og:url" content="https://substrate-developer-hub.github.io/substrate-how-to-guides/docs/pallet-design/add-contracts-pallet"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Use the Contracts pallet | Substrate How-to Guides"><meta data-react-helmet="true" name="description" content="Create the basis for building Wasm smart contracts using FRAME."><meta data-react-helmet="true" property="og:description" content="Create the basis for building Wasm smart contracts using FRAME."><meta data-react-helmet="true" name="keywords" content="pallet design, intermediate, runtime"><link data-react-helmet="true" rel="shortcut icon" href="/substrate-how-to-guides/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://substrate-developer-hub.github.io/substrate-how-to-guides/docs/pallet-design/add-contracts-pallet"><link data-react-helmet="true" rel="alternate" href="https://substrate-developer-hub.github.io/substrate-how-to-guides/docs/pallet-design/add-contracts-pallet" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://substrate-developer-hub.github.io/substrate-how-to-guides/docs/pallet-design/add-contracts-pallet" hreflang="x-default"><link rel="stylesheet" href="/substrate-how-to-guides/assets/css/styles.ddf35dcd.css">
<link rel="preload" href="/substrate-how-to-guides/assets/js/styles.4e9475fc.js" as="script">
<link rel="preload" href="/substrate-how-to-guides/assets/js/runtime~main.03430287.js" as="script">
<link rel="preload" href="/substrate-how-to-guides/assets/js/main.e23bc034.js" as="script">
<link rel="preload" href="/substrate-how-to-guides/assets/js/1.d7085503.js" as="script">
<link rel="preload" href="/substrate-how-to-guides/assets/js/2.4b4dc6ee.js" as="script">
<link rel="preload" href="/substrate-how-to-guides/assets/js/3.e54a3ba2.js" as="script">
<link rel="preload" href="/substrate-how-to-guides/assets/js/1be78505.422b7c74.js" as="script">
<link rel="preload" href="/substrate-how-to-guides/assets/js/57.c98a8113.js" as="script">
<link rel="preload" href="/substrate-how-to-guides/assets/js/935f2afb.3fcbe484.js" as="script">
<link rel="preload" href="/substrate-how-to-guides/assets/js/55.2ccda45a.js" as="script">
<link rel="preload" href="/substrate-how-to-guides/assets/js/17896441.338d778a.js" as="script">
<link rel="preload" href="/substrate-how-to-guides/assets/js/642b72db.ea1e32c9.js" as="script">
</head>
<body data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/substrate-how-to-guides/"><img src="/substrate-how-to-guides/img/substrate.png" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/substrate-how-to-guides/img/substrate.png" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Welcome</strong></a><a class="navbar__item navbar__link navbar__link--active" href="/substrate-how-to-guides/docs/intro">How-to Guides</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/substrate-developer-hub/substrate-how-to-guides/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="dsla-search-wrapper"><div class="dsla-search-field"></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/substrate-how-to-guides/"><img src="/substrate-how-to-guides/img/substrate.png" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/substrate-how-to-guides/img/substrate.png" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Welcome</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/substrate-how-to-guides/docs/intro">How-to Guides</a></li><li class="menu__list-item"><a href="https://github.com/substrate-developer-hub/substrate-how-to-guides/" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/substrate-how-to-guides/docs/intro">Welcome</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Basics</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/substrate-how-to-guides/docs/basics/basic-pallet-integration">Basic pallet integration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/substrate-how-to-guides/docs/basics/mint-token">Primitive token mint</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/substrate-how-to-guides/docs/basics/genesis-config-balances">Configuring genesis for Balances</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/substrate-how-to-guides/docs/basics/configurable-constants">Configure a runtime constant</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/substrate-how-to-guides/docs/basics/basic-tx-weight-calculations">Calculating transaction weights</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/substrate-how-to-guides/docs/basics/basic-instantiable-pallets">Basic instantiable pallets</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/substrate-how-to-guides/docs/basics/helper-functions">Using helper functions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/substrate-how-to-guides/docs/basics/publish-pallet">Publish a pallet to its own crate</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Pallet design</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/substrate-how-to-guides/docs/pallet-design/storage-value-struct">Create and use a struct in storage</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/substrate-how-to-guides/docs/pallet-design/simple-crowdfund">Simple crowdfund</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/substrate-how-to-guides/docs/pallet-design/lockable-currency">Simple staking pallet</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/substrate-how-to-guides/docs/pallet-design/add-contracts-pallet">Use the Contracts pallet</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/substrate-how-to-guides/docs/pallet-design/randomness">Generating on-chain randomness</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/substrate-how-to-guides/docs/pallet-design/storage-map">Create and use a storage Map</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Weights</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/substrate-how-to-guides/docs/weights/conditional-weight-struct">Conditional weighting struct</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/substrate-how-to-guides/docs/weights/linear-weight-struct">Linear weighting struct</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/substrate-how-to-guides/docs/weights/quadratic-weight-struct">Quadratic weighting struct</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/substrate-how-to-guides/docs/weights/calculate-fees">Calculating fees</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Testing</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/substrate-how-to-guides/docs/testing/test-transfer">Testing a transfer function</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/substrate-how-to-guides/docs/testing/basic-pallet-testing">Setting up tests for your pallet</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Storage Migrations</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/substrate-how-to-guides/docs/storage-migrations/nicks-migration">Basic storage migration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/substrate-how-to-guides/docs/storage-migrations/migration-steps-polkadotjs">Trigger a storage migration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/substrate-how-to-guides/docs/storage-migrations/migration-tests">Migration tests</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/substrate-how-to-guides/docs/storage-migrations/ringbuffer">Ringbuffer queue</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Tools</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/substrate-how-to-guides/docs/tools/integrate-try-runtime">Include `try-runtime` in your project</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/substrate-how-to-guides/docs/tools/create-tx-wrapper-package">Create a `txwrapper` for a chain</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/substrate-how-to-guides/docs/tools/auction-winners-sidecar">Track Parachain auction winners using Substrate API Sidecar</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Consensus</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/substrate-how-to-guides/docs/consensus/pow-consensus">Configure a chain to POW consensus</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Parachains</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/substrate-how-to-guides/docs/parachains/overview">Parachains Guide Overview</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Collators</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/substrate-how-to-guides/docs/parachains/a-collators/start-collator-node">Start a collator node and add more collators</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Runtime Upgrades</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/substrate-how-to-guides/docs/parachains/b-runtime-upgrades/runtime-upgrades">Preparing for On-Chain Upgrades</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/substrate-how-to-guides/docs/parachains/b-runtime-upgrades/setup-runtime-and-client">Set-up your runtime and client</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Registration</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/substrate-how-to-guides/docs/parachains/c-registration/register-paraID">How to reserve a ParaID</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/substrate-how-to-guides/docs/parachains/c-registration/register-parachain">How to register your Parachain</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Other</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/substrate-how-to-guides/docs/parachains/e-other/start-testnet">Start a testnet on Rococo</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Tutorials</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Kitties</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/substrate-how-to-guides/docs/tutorials/Kitties/overview">ðŸ˜º Substrate Kitties</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/substrate-how-to-guides/docs/tutorials/Kitties/basic-setup">Part I: Basic set-up</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/substrate-how-to-guides/docs/tutorials/Kitties/create-kitties">Part II: Uniqueness, custom types and storage maps</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/substrate-how-to-guides/docs/tutorials/Kitties/dispatchables-and-events">Part III: Dispatchables and Events</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/substrate-how-to-guides/docs/tutorials/Kitties/interacting-functions">Part IV: Interacting with your Kitties</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/substrate-how-to-guides/docs/tutorials/Kitties/kitties-frontend">Part V: Kitties front-end</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Want to Contribute?</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/substrate-how-to-guides/docs/contribute/how-to-template">How-to Template</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">Use the Contracts pallet</h1></header><div class="markdown"><p><em>Create the basis for building Wasm smart contracts using FRAME.</em></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="goal"></a>Goal<a class="hash-link" href="#goal" title="Direct link to heading">#</a></h2><p>Add the Contracts pallet to your runtime to be able to use Wasm smart contracts in your blockchain.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="use-cases"></a>Use cases<a class="hash-link" href="#use-cases" title="Direct link to heading">#</a></h2><ul><li>Smart Contract develoment</li><li>On-chain execution of Wasm binaries</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="overview"></a>Overview<a class="hash-link" href="#overview" title="Direct link to heading">#</a></h2><p>This guide will show you how you can add the <a href="https://substrate.dev/rustdocs/latest/pallet_contracts/" target="_blank" rel="noopener noreferrer">Contracts pallet</a> to your runtime in order to allow your blockchain
to support Wasm smart contracts. You can follow similar patterns to add additional FRAME pallets to your runtime,
however you should note that each pallet is a little different in terms of the specific configuration settings
needed to use it correctly.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>You should already have the latest version of the Substrate Node Template compiled on your computer to follow this guide.
If you haven&#x27;t already done so, refer to <a href="https://substrate.dev/docs/en/tutorials/create-your-first-substrate-chain/" target="_blank" rel="noopener noreferrer">this tutorial</a>.</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="steps"></a>Steps<a class="hash-link" href="#steps" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="1-import-the-dependencies"></a>1. Import the dependencies<a class="hash-link" href="#1-import-the-dependencies" title="Direct link to heading">#</a></h3><p>Refer to this guide to properly include Contracts in your runtime.</p><p>This includes <strong>updating <code>runtime/Cargo.toml</code></strong> and <strong>runtime/Cargo.toml` with:</strong> - <code>pallet-contracts</code> - <code>pallet-contracts-primitives</code></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="2-add-the-contracts-pallet-to-your-runtime"></a>2. Add the Contracts pallet to your runtime<a class="hash-link" href="#2-add-the-contracts-pallet-to-your-runtime" title="Direct link to heading">#</a></h3><p>Now you&#x27;ll have to implement the Contract&#x27;s pallet <a href="https://substrate.dev/rustdocs/latest/pallet_contracts/trait.Config.html" target="_blank" rel="noopener noreferrer">configuration traits</a> in order for your runtime to use it properly.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="implement-pallet_contracts"></a>Implement <code>pallet_contracts</code><a class="hash-link" href="#implement-pallet_contracts" title="Direct link to heading">#</a></h4><p>Start by making sure you&#x27;ve included all of the types that <code>pallet_contracts</code> exposes. You can copy these from <a href="https://substrate.dev/rustdocs/latest/pallet_contracts/" target="_blank" rel="noopener noreferrer">FRAME&#x27;s source code</a> (assuming versioning is equivalent to the imported crate). Here&#x27;s what you need to add inside <code>runtime/lib.rs</code> â€” only the first 4 types are shown:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly rust"><div tabindex="0" class="prism-code language-rust codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">impl pallet_contracts::Config for Runtime {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    type Time = Timestamp;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    type Randomness = RandomnessCollectiveFlip;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    type Currency = Balances;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    type Event = Event;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /* --snip-- */</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="parameter-types"></a>Parameter types<a class="hash-link" href="#parameter-types" title="Direct link to heading">#</a></h4><p>Some of these types require <code>parameter_types</code>. Have a look at their implementation in <a href="https://github.com/paritytech/substrate/blob/master/bin/node/runtime/src/lib.rs#L786" target="_blank" rel="noopener noreferrer">this</a> runtime to make sure you include everything. We&#x27;ll take <code>DeletionQueueDepth</code> as one example. Parameter types go right above <code>impl pallet_contracts::Config for Runtime</code> :</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly rust"><div tabindex="0" class="prism-code language-rust codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">parameter_types! {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">     /* --snip-- */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    pub DeletionQueueDepth: u32 = ((DeletionWeightLimit::get() / (</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &lt;Runtime as pallet_contracts::Config&gt;::WeightInfo::on_initialize_per_queue_item(1) -</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &lt;Runtime as pallet_contracts::Config&gt;::WeightInfo::on_initialize_per_queue_item(0)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        )) / 5) as u32;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        /* --snip-- */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Notice how the above parameter type requires <code>WeightInfo</code>. This requires you to add the following to the top of <code>runtime/lib.rs</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly rust"><div tabindex="0" class="prism-code language-rust codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">use pallet_contracts::weights::WeightInfo;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Similarly, other parameter types use constants such as <code>DAYS</code>, <code>MILLICENTS</code> and <code>AVERAGE_ON_INITIALIZE_RATIO</code>.</p><p>Define these towards the top of your <code>runtime/lib.rs</code> file where the other constants exists:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly rust"><div tabindex="0" class="prism-code language-rust codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">// Contracts price units.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">pub const MILLICENTS: Balance = 1_000_000_000;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">pub const CENTS: Balance = 1_000 * MILLICENTS;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">pub const DOLLARS: Balance = 100 * CENTS;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">const fn deposit(items: u32, bytes: u32) -&gt; Balance {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    items as Balance * 15 * CENTS + (bytes as Balance) * 6 * CENTS</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// We assume that ~10% of the block weight is consumed by `on_initalize` handlers.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/// This is used to limit the maximal weight of a single extrinsic.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">const AVERAGE_ON_INITIALIZE_RATIO: Perbill = Perbill::from_percent(10);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="add-an-instance-in-runtime-for-pallet_contracts"></a>Add an instance in runtime for <code>pallet_contracts</code><a class="hash-link" href="#add-an-instance-in-runtime-for-pallet_contracts" title="Direct link to heading">#</a></h4><p>Ceate an instance of the Contracts pallet in <code>construct_macro!</code> inside <code>runtime/lib.rs</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly rust"><div tabindex="0" class="prism-code language-rust codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">/* --snip-- */</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> Contracts: pallet_contracts::{Module, Call, Config&lt;T&gt;, Storage, Event&lt;T&gt;},</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> /* --snip-- */</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="3-add-api-dependencies"></a>3. Add API dependencies<a class="hash-link" href="#3-add-api-dependencies" title="Direct link to heading">#</a></h3><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>Some pallets, including the Contracts pallet, expose custom runtime APIs and RPC endpoints. In the case of the Contracts pallet, this enables reading contracts state from off chain.</p></div></div><p>In this guide, we want to use the Contracts pallet to make calls to our node&#x27;s storage without making a transaction.</p><p>To achieve this, we&#x27;ll use another pallet called <code>pallet-contracts-rpc-runtime-api</code>.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="import-dependencies"></a>Import dependencies<a class="hash-link" href="#import-dependencies" title="Direct link to heading">#</a></h4><p>Just like in the first step of this guide, update <code>Cargo.toml</code> to add <code>pallet-contracts-rpc-runtime-api</code>.</p><p>Now we can add the <a href="https://substrate.dev/rustdocs/latest/pallet_contracts_rpc_runtime_api/trait.ContractsApi.html" target="_blank" rel="noopener noreferrer"><code>ContractsApi</code></a> dependency required to implement the Contracts runtime API.</p><p>Add this with the other <code>use</code> statements.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="implement-the-contracts-runtime-api"></a>Implement the Contracts runtime API<a class="hash-link" href="#implement-the-contracts-runtime-api" title="Direct link to heading">#</a></h4><p>We&#x27;re now ready to implement the contracts
runtime API.</p><p>This happens in the
<code>impl_runtime_apis! </code>macro near the end of your
runtime.</p><p>Make sure to add the following functions that the <code>ContractsApi</code> exposes:</p><ul><li><strong><code>call()</code></strong>: returns <code>pallet_contracts_primitives::ContractExecResult { Contracts::bare_call(origin, dest, value, gas_limit, input_data)}</code></li><li><strong><code>get_storage()</code></strong>: returns <code>pallet_contracts_primitives::GetStorageResult {Contracts::get_storage(address, key)}</code></li><li><strong><code>rent_projection()</code></strong>: returns <code>pallet_contracts_primitives::RentProjectionResult&lt;BlockNumber&gt; {Contracts::rent_projection(address)}</code></li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="add-rpc-api-extension"></a>Add RPC API extension<a class="hash-link" href="#add-rpc-api-extension" title="Direct link to heading">#</a></h4><p>To be able to call the runtime API, we must add the RPC to the node&#x27;s service.</p><p>In <code>node/Cargo.toml</code>, add the dendencies for <code>pallet-contracts</code> and <code>pallet-contracts-rpc</code>.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Unsure what version to include?</h5></div><div class="admonition-content"><p>Use the latest version as indicated on <a href="https://crates.io/search?q=pallet-contracts-rpc" target="_blank" rel="noopener noreferrer">crates.io</a>.</p></div></div><p>This RPC does not contain access to the Contracts pallet by default. To interact with this pallet, we have to <strong>extend the existing RPC and add the Contracts pallet</strong> along with its API.</p><p>In <code>node/src/rpc.rs</code>, add this line to the <code>where</code> clause in <code>create_full&lt;C, P&gt;</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly rust"><div tabindex="0" class="prism-code language-rust codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> C::Api: pallet_contracts_rpc::ContractsRuntimeApi&lt;Block, AccountId, Balance, BlockNumber&gt;,</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>And add the contracts RPC API extension using:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly rust"><div tabindex="0" class="prism-code language-rust codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> // Contracts RPC API extension</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   io.extend_with(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       ContractsApi::to_delegate(Contracts::new(client.clone()))</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   );</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="examples"></a>Examples<a class="hash-link" href="#examples" title="Direct link to heading">#</a></h2><ul><li><code>canvas-node</code> <a href="https://github.com/paritytech/canvas-node/blob/master/runtime/src/lib.rs#L361" target="_blank" rel="noopener noreferrer">runtime</a></li><li><code>canvas-node</code> <a href="https://github.com/paritytech/canvas-node/blob/master/node/src/rpc.rs" target="_blank" rel="noopener noreferrer">rpc file</a></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="related-material"></a>Related material<a class="hash-link" href="#related-material" title="Direct link to heading">#</a></h2><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="rust-docs"></a>Rust docs<a class="hash-link" href="#rust-docs" title="Direct link to heading">#</a></h4><ul><li><a href="https://substrate.dev/rustdocs/latest/pallet_contracts/index.html" target="_blank" rel="noopener noreferrer"><code>pallet_contracts</code> crate</a></li><li><a href="https://substrate.dev/rustdocs/latest/pallet_contracts_rpc/index.html" target="_blank" rel="noopener noreferrer"><code>pallet_contracts_rpc</code> crate</a></li></ul></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/substrate-developer-hub/substrate-how-to-guides/edit/main/docs/02-pallet-design/add-contracts-pallet.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/substrate-how-to-guides/docs/pallet-design/lockable-currency"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Simple staking pallet</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/substrate-how-to-guides/docs/pallet-design/randomness"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Generating on-chain randomness Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#goal" class="table-of-contents__link">Goal</a></li><li><a href="#use-cases" class="table-of-contents__link">Use cases</a></li><li><a href="#overview" class="table-of-contents__link">Overview</a></li><li><a href="#steps" class="table-of-contents__link">Steps</a><ul><li><a href="#1-import-the-dependencies" class="table-of-contents__link">1. Import the dependencies</a></li><li><a href="#2-add-the-contracts-pallet-to-your-runtime" class="table-of-contents__link">2. Add the Contracts pallet to your runtime</a></li><li><a href="#3-add-api-dependencies" class="table-of-contents__link">3. Add API dependencies</a></li></ul></li><li><a href="#examples" class="table-of-contents__link">Examples</a></li><li><a href="#related-material" class="table-of-contents__link">Related material</a></li></ul></div></div></div><div><fieldset class="MuiBox-root jss12"><legend class="MuiTypography-root MuiTypography-body1">Was this guide useful?</legend><span class="MuiRating-root"><label class="MuiRating-label" for="customized-icons-1"><span class="MuiRating-icon MuiRating-iconFilled"><svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><circle cx="15.5" cy="9.5" r="1.5"></circle><circle cx="8.5" cy="9.5" r="1.5"></circle><path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm0-6c-2.33 0-4.32 1.45-5.12 3.5h1.67c.69-1.19 1.97-2 3.45-2s2.75.81 3.45 2h1.67c-.8-2.05-2.79-3.5-5.12-3.5z"></path></svg></span><span class="MuiRating-visuallyhidden">Very Dissatisfied</span></label><input type="radio" value="1" id="customized-icons-1" name="customized-icons" class="MuiRating-visuallyhidden"><label class="MuiRating-label" for="customized-icons-2"><span class="MuiRating-icon MuiRating-iconFilled"><svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><circle cx="15.5" cy="9.5" r="1.5"></circle><circle cx="8.5" cy="9.5" r="1.5"></circle><path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm0-3.5c.73 0 1.39.19 1.97.53.12-.14.86-.98 1.01-1.14-.85-.56-1.87-.89-2.98-.89-1.11 0-2.13.33-2.99.88.97 1.09.01.02 1.01 1.14.59-.33 1.25-.52 1.98-.52z"></path></svg></span><span class="MuiRating-visuallyhidden">Dissatisfied</span></label><input type="radio" value="2" id="customized-icons-2" name="customized-icons" checked="" class="MuiRating-visuallyhidden"><label class="MuiRating-label" for="customized-icons-3"><span class="MuiRating-icon MuiRating-iconEmpty"><svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><circle cx="15.5" cy="9.5" r="1.5"></circle><circle cx="8.5" cy="9.5" r="1.5"></circle><path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm0-4c-.73 0-1.38-.18-1.96-.52-.12.14-.86.98-1.01 1.15.86.55 1.87.87 2.97.87 1.11 0 2.12-.33 2.98-.88-.97-1.09-.01-.02-1.01-1.15-.59.35-1.24.53-1.97.53z"></path></svg></span><span class="MuiRating-visuallyhidden">Neutral</span></label><input type="radio" value="3" id="customized-icons-3" name="customized-icons" class="MuiRating-visuallyhidden"><label class="MuiRating-label" for="customized-icons-4"><span class="MuiRating-icon MuiRating-iconEmpty"><svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><circle cx="15.5" cy="9.5" r="1.5"></circle><circle cx="8.5" cy="9.5" r="1.5"></circle><path d="M12 16c-1.48 0-2.75-.81-3.45-2H6.88c.8 2.05 2.79 3.5 5.12 3.5s4.32-1.45 5.12-3.5h-1.67c-.69 1.19-1.97 2-3.45 2zm-.01-14C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"></path></svg></span><span class="MuiRating-visuallyhidden">Satisfied</span></label><input type="radio" value="4" id="customized-icons-4" name="customized-icons" class="MuiRating-visuallyhidden"><label class="MuiRating-label" for="customized-icons-5"><span class="MuiRating-icon MuiRating-iconEmpty"><svg class="MuiSvgIcon-root" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><circle cx="15.5" cy="9.5" r="1.5"></circle><circle cx="8.5" cy="9.5" r="1.5"></circle><path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm-5-6c.78 2.34 2.72 4 5 4s4.22-1.66 5-4H7z"></path></svg></span><span class="MuiRating-visuallyhidden">Very Satisfied</span></label><input type="radio" value="5" id="customized-icons-5" name="customized-icons" class="MuiRating-visuallyhidden"></span></fieldset></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Learn Substrate</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/substrate-how-to-guides/docs/intro">How-to Guides</a></li><li class="footer__item"><a class="footer__link-item" href="/substrate-how-to-guides/docs/tutorials/kitties/overview">Tutorials</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">The Substrate How-to Guides are GPL 3.0 Licensed, open source and open for contributions.</div></div></div></footer></div>
<script src="/substrate-how-to-guides/assets/js/styles.4e9475fc.js"></script>
<script src="/substrate-how-to-guides/assets/js/runtime~main.03430287.js"></script>
<script src="/substrate-how-to-guides/assets/js/main.e23bc034.js"></script>
<script src="/substrate-how-to-guides/assets/js/1.d7085503.js"></script>
<script src="/substrate-how-to-guides/assets/js/2.4b4dc6ee.js"></script>
<script src="/substrate-how-to-guides/assets/js/3.e54a3ba2.js"></script>
<script src="/substrate-how-to-guides/assets/js/1be78505.422b7c74.js"></script>
<script src="/substrate-how-to-guides/assets/js/57.c98a8113.js"></script>
<script src="/substrate-how-to-guides/assets/js/935f2afb.3fcbe484.js"></script>
<script src="/substrate-how-to-guides/assets/js/55.2ccda45a.js"></script>
<script src="/substrate-how-to-guides/assets/js/17896441.338d778a.js"></script>
<script src="/substrate-how-to-guides/assets/js/642b72db.ea1e32c9.js"></script>
</body>
</html>